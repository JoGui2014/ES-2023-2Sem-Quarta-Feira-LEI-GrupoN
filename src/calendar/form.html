<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.10.2/fullcalendar.min.css" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.10.2/fullcalendar.min.js"></script>
    <link rel="stylesheet" type="text/css" href="styles.css">
</head>

<select id="dropdownCursos" class="custom-select"></select>

<body>
<div id="calendar"></div>
<script>

        function criarBloco(curso, title, turno, prof, nInscricoes, diaSemana, horaInicio, horaFim, data, sala, lotacao) {
        var start = data + 'T' + horaInicio + ':00';
        var end = data + 'T' + horaFim + ':00';

        return {
          curso: curso,
          title: title,
          turno: turno,
          prof: prof,
          nInscricoes: nInscricoes,
          diaSemana: diaSemana,
          start: start,
          end: end,
          sala: sala,
          lotacao: lotacao
        };
      }

        var blocos = [
            criarBloco('MEC', 'Disciplina A', 'manha', 'Luis', '5', 'quarta', '08:30', '09:00', '2023-05-01', 'D104', '10'),
            criarBloco('LEI', 'Disciplina B', 'tarde', 'Maria', '3', 'terça', '10:30', '11:00', '2023-05-02', 'D105', '12'),
            criarBloco('MAT', 'Disciplina C', 'noite', 'João', '4', 'quinta', '19:00', '19:30', '2023-05-03', 'D106', '14'),
            criarBloco('MEC', 'Disciplina D', 'manha', 'Ana', '2', 'segunda', '09:00', '09:30', '2023-05-04', 'D107', '15'),
            criarBloco('LP', 'Disciplina E', 'tarde', 'Carlos', '1', 'sexta', '14:30', '15:00', '2023-05-05', 'D108', '11'),
            criarBloco('LEI', 'Disciplina A', 'manha', 'Luis', '5', 'quarta', '08:30', '09:00', '2023-05-01', 'D104', '10'),
            criarBloco('LC', 'Disciplina B', 'tarde', 'Maria', '3', 'segunda', '13:30', '14:00', '2023-05-02', 'D105', '12'),
            criarBloco('LP', 'Disciplina C', 'noite', 'João', '4', 'terça', '18:00', '18:30', '2023-05-03', 'D106', '14'),
            criarBloco('MEC', 'Disciplina D', 'manha', 'Ana', '2', 'quinta', '10:00', '10:30', '2023-05-04', 'D107', '15'),
            criarBloco('LEI', 'Disciplina E', 'tarde', 'Carlos', '1', 'sexta', '14:30', '15:00', '2023-05-05', 'D108', '11'),
            criarBloco('LP', 'Disciplina F', 'manha', 'Pedro', '6', 'quarta', '11:00', '11:30', '2023-05-06', 'D109', '10'),
            criarBloco('MAT', 'Disciplina G', 'noite', 'Julia', '4', 'quinta', '20:00', '20:30', '2023-05-07', 'D110', '12'),
            criarBloco('LEI', 'Disciplina H', 'tarde', 'Mariana', '3', 'sexta', '15:00', '15:30', '2023-05-08', 'D111', '13'),
            ];


        var cursos = {};

        for (var i = 0; i < blocos.length; i++) {
          var curso = blocos[i].curso;
          cursos[curso] = true;
        }

        var cursosUnique = Object.keys(cursos);

      var dropdownCursos = document.getElementById("dropdownCursos");

      for (var i = 0; i < cursosUnique.length; i++) {
        var option = document.createElement("option");
        option.text = cursosUnique[i-1];
        dropdownCursos.add(option);
      }

      var cursoSelecionado = ""; // Definir variável para armazenar a opção selecionada

      dropdownCursos.addEventListener("change", function() {
        cursoSelecionado = dropdownCursos.value;

        var blocoSelecionado = blocos.filter(function(bloco) {
        return bloco.curso === cursoSelecionado;
      });


      dropdownCursos.classList.add("hide");


    // Inicializar o FullCalendar
    $('#calendar').fullCalendar({
      header: {
        left: 'prev,next today',
        center: 'title',
        right: 'month,agendaWeek,agendaDay'
      },
      height: 'auto', // Ajustar automaticamente a altura ao número de eventos
      contentHeight: 'auto', // Ajustar a altura do conteúdo do calendário para que caiba todos os eventos
      defaultView: 'agendaWeek',
      minTime: '08:00:00', // Hora de início do horário
      maxTime: '20:30:00', // Hora de término do horário
      slotDuration: '00:30:00', // Duração de cada slot de tempo (30 minutos)
      slotLabelFormat: 'h:mm A', // Formato do rótulo de tempo
      allDaySlot: false, // Não mostrar o slot de tempo para o dia inteiro
      events: blocoSelecionado, // Passar a lista de "blocos" como eventos do FullCalendar

      eventRender: function(event, element) {
        // Montar o título do evento com o nome da disciplina e a sala
        var title = event.title + ' - Sala ' + event.sala;
        // Adicionar um botão para ver mais detalhes
        var detailsButton = $('<button>').addClass('btn btn-sm btn-info').text('Ver detalhes');
        element.find('.fc-title').append(detailsButton);
        // Definir o título no elemento do evento
        element.find('.fc-title').text(title);
      },
      eventClick: function(event) {

        if ($('#event-details-modal').length > 0) {
        $('#event-details-modal').remove();
      }

        // Criar o modal com as informações do evento
        var modal = $('<div>').addClass('modal fade').attr('id', 'event-details-modal');
        var modalDialog = $('<div>').addClass('modal-dialog');
        var modalContent = $('<div>').addClass('modal-content');
        var modalHeader = $('<div>').addClass('modal-header').html('<h5 class="modal-title">' + event.title);
        var modalBody = $('<div>').addClass('modal-body').html('Professor: ' + event.prof + '<br>Número de inscrições: ' + event.nInscricoes + '<br>Tamanho da sala: ' + event.lotacao + '<br>Curso: ' + event.curso);
        modalContent.append(modalHeader, modalBody);
        modalDialog.append(modalContent);
        modal.append(modalDialog);

        // Adicionar o modal ao corpo da página e exibi-lo
        $('body').append(modal);
        modal.modal('show');
      }
    });

    });
  </script>
</body>
</html>
